name: Generate Custom Snake Animation

on:
  schedule: # execute every 12 hours
    - cron: "0 */12 * * *"

  workflow_dispatch:

  push:
    branches:
      - master

jobs:
  generate:
    permissions:
      contents: write
    runs-on: ubuntu-latest
    timeout-minutes: 5

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Generate snake.svg using bash
        run: |
          mkdir -p dist
          cat <<EOF > dist/snake.svg
          <svg xmlns="http://www.w3.org/2000/svg" width="600" height="200">
            <!-- Snake body -->
            <rect x="50" y="100" width="20" height="20" fill="#88C0D0" />
            <rect x="70" y="95" width="20" height="20" fill="#81A1C1" />
            <rect x="90" y="105" width="20" height="20" fill="#5E81AC" />
            <rect x="110" y="100" width="20" height="20" fill="#BF616A" />
            <rect x="130" y="95" width="20" height="20" fill="#D08770" />
            <rect x="150" y="105" width="20" height="20" fill="#EBCB8B" />
            <rect x="170" y="100" width="20" height="20" fill="#A3BE8C" />
            <rect x="190" y="95" width="20" height="20" fill="#B48EAD" />
            <!-- Snake head -->
            <circle cx="210" cy="105" r="10" fill="#2E3440" />
          </svg>
          EOF

      - name: Commit and push snake.svg to the output branch
        uses: crazy-max/ghaction-github-pages@v3.1.0
        with:
          target_branch: output
          build_dir: dist
          commit_message: "Update custom snake animation - $(date +'%Y-%m-%d %H:%M:%S')"
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
